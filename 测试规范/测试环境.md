# 虚拟机环境地址
- **Baseline:**\\168.160.184.70\测试环境\Hyper-V\Baseline
- **Product:**\\168.160.184.70\测试环境\Hyper-V\Product 

# 虚拟环境安装配置 
* 安装版本：Hyper-v Server 2012 
* 安装与配置方法：url：https://github.com/wanfangdata/guide/blob/master/环境配置/Hyper-V Server 2012 安装与配置.md
* 拷贝虚拟环境：将最新版本目录下的文件拷贝到本地路径 （虚拟文件路径：\\168.160.184.70\测试环境\Hyper-V\Product )
* 创建虚拟机：  
1、打开hyper-v管理器  
2、右键物理机，选择新建虚拟机  
3、弹出虚拟机新建向导  
4、指定虚拟机名字和存储位置  
5、选择虚拟机版本，目前使用的一代，一代和之前的兼容，注意选择后以后不能更改   
6、设置虚拟机内存    
7、虚拟机选择网络  
8、指定虚拟机硬盘：使用现有虚拟硬盘  
9、确认信息摘要，点击完成  
10、启动虚拟机  

# 虚拟机部署方案 
* 拷贝虚拟机测试环境，虚拟环境基线：\\168.160.184.70\测试环境\Hyper-V\Baseline  
* 自动分配IP地址，自动化脚本路径：\\168.160.184.70\测试环境\Hyper-V\Scripts\ip 

# 虚拟机更新规则 
* C盘一律不更新
* D盘只更新Web站点、Service服务、SqlData，更新文件如果修改了配置文件，需要执行D:\update-log4net.ps1 控制日志大小
* E盘只新增比较大且不需要经常更新的数据库文件<br> 
* 其它数据如需放在测试服务器本地，需要在【设置-存储-SCSI控制器】添加虚拟硬盘（文件格式：VHD，存储在物理硬盘上：动态分配，文件大小：限制在5G以内） 

# 测试站点域名地址映射(host文件)
* 自动设置host脚本:\\168.160.184.70\测试环境\Scripts\host 

# 项目中测试虚拟机的管理 
- **项目开始前：** 从产品基线虚拟机的最新版本中克隆出本项目使用的测试虚拟机 
- **项目中：** 使用测试虚拟机测试      
- **项目验收前：** 根据部署说明将产品部署到产品基线虚拟机上，保证验收在产品基线虚拟机上进行
- **项目验收后：** 备份产品基线虚拟机（可积累2～3个项目在进行一次备份）
